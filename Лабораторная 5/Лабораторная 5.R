#2. –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–æ–≥ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
set.seed(123)
Œ¥ = 0.0001   #—Ç.–∫. ‚àö‚àÜ = 0.01
n = 1000
k = seq(0, n, by = 1)
e = rnorm(n + 1, 0, sqrt(Œ¥)) 
B = 0

for (k in 1:n) {
  B[k + 1] = B[k] + e[k] 
}

plot(seq(0, Œ¥ * 1000, Œ¥), B, type = 'l', main = "–î–∏—Å–∫. –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ (–ø—Ä–æ—Ü–µ—Å—Å 8)", col = "blue")

#3. –ê–Ω—Å–∞–º–±–ª—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
plot(seq(0, Œ¥ * 1000, Œ¥), B, type = 'l', ylim = c(-1, 1), col = "lightblue", main = "–ê–Ω—Å–∞–º–±–ª—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π:")

for (k in 1:200) {
  e = rnorm(n + 1, 0, sqrt(Œ¥)) 
  for (k in 1:n) {
    B[k + 1] = B[k] + e[k] 
  }
  lines(seq(0, Œ¥ * 1000, Œ¥), B, type = 'l', col = "lightblue")
}

#4. –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø–æ –ø—Ä–∞–≤–∏–ª—É —Ç—Ä–µ—Ö —Å–∏–≥–º
#–î–ò: P(Ô∏Å‚àí3‚àöùëò‚àÜ ‚â§ ùêµùëò‚àÜ ‚â§ 3‚àöùëò‚àÜ)Ô∏Å= 0.997, ùëò ‚â• 0

kŒ¥ = seq(0, 1000) * Œ¥
up = 3 * sqrt(kŒ¥)  #–≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –î–ò
low = -3 * sqrt(kŒ¥)  #–Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –î–ò

lines(seq(0, Œ¥ * 1000, Œ¥), up, type = 'l', col = "red")
lines(seq(0, Œ¥ * 1000, Œ¥), low, type = 'l', col = "red")

legend("topright", legend = c("–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª"), col = c("red"), bty = "n", lwd = 1)

# 5. –ü—Ä–æ—Ü–µ—Å—Å 9 - —Ä–µ—à–µ–Ω–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è St (–∏–Ω—Ç–µ–≥. —É—Ä-–µ, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–µ –≥–µ–æ–º. –±—Ä–æ—É–Ω –¥–≤–∏–∂–µ–Ω–∏–µ) 
#—Å –Ω.—É S0 (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è)
S = numeric(length = n + 1)
S0 = 1
a = 0.5
œÉ = 0.9
Œ¥ = 0.0001
B = 0
k = seq(0, n, by = 1)

for (k in 1:n) {
  B[k + 1] = B[k] + e[k+1]
}
for (k in 1:(n+1)) {
  S[k] = S0 * exp((a - œÉ^2 / 2) * k * Œ¥ + œÉ * B[k]) #(a - œÉ^2 / 2) - –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–Ω–æ—Å, œÉ^2 - –¥–∏—Ñ—Ñ—É–∑–∏—è
}

plot(seq(0, Œ¥ * 1000, Œ¥), S, type = 'l', col = "blue", main = "–ü—Ä–æ—Ü–µ—Å—Å 9:")

#6. –ê–Ω—Å–∞–º–±–ª—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
plot(seq(0, Œ¥ * 1000, Œ¥), B, type = 'l', ylim = c(-1, 1), col = "lightblue", main = "–ê–Ω—Å–∞–º–±–ª—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π:")

for (k in 1:200) {
  e = rnorm(n + 1, 0, sqrt(Œ¥)) 
  for (k in 1:n) {
    B[k + 1] = B[k] + e[k] 
    S[k+1] = S0 * exp((a - œÉ^2 / 2) * (k + 1) * Œ¥ + œÉ * B[k + 1])
  }
  lines(seq(0, Œ¥ * 1000, Œ¥), B, type = 'l', col = "lightblue")
}
